# 엑셀 다운로드

```java
List<xxxVo> list = xxxService.findAllPrivacyInfo(xxxVo);

String fileName = "";
for(xxxVo vo : list) {
    fileName = vo.getTitle();
}

String gubun_name ="";

String sFileName = fileName+"_개인정보.xlsx";
try {
    sFileName = java.net.URLEncoder.encode(sFileName, "UTF-8");
} catch (UnsupportedEncodingException e) {
    throw new RuntimeException("엑셀 파일명 인코딩에 실패하였습니다.");
}
response.reset();

response.setContentType("application/vnd.ms-excel");
response.setHeader("Content-Disposition", "attachment; filename=" + sFileName + ";");
OutputStream fileOut = null;

//1차로 workbook을 생성
XSSFWorkbook workbook = new XSSFWorkbook();
//2차는 sheet생성
String title = fileName+"_개인정보.xlsx";
XSSFSheet sheet=workbook.createSheet(title);
//엑셀의 행
XSSFRow row=null;
//엑셀의 셀
XSSFCell cell=null;

XSSFCellStyle style = workbook.createCellStyle();
XSSFCellStyle dateStyle = workbook.createCellStyle();
XSSFFont font = workbook.createFont();
font.setFontName("맑은 고딕");
style.setAlignment(XSSFCellStyle.ALIGN_CENTER);
style.setBorderTop(XSSFCellStyle.BORDER_THIN);
style.setBorderBottom(XSSFCellStyle.BORDER_THIN);
style.setBorderRight(XSSFCellStyle.BORDER_THIN);
style.setBorderLeft(XSSFCellStyle.BORDER_THIN);// 아랫쪽에 얇은 실선 적용.
style.setFillForegroundColor(HSSFColor.GREY_25_PERCENT.index);
style.setFillPattern(XSSFCellStyle.SOLID_FOREGROUND );

dateStyle.setAlignment(XSSFCellStyle.ALIGN_CENTER);
dateStyle.setBorderTop(XSSFCellStyle.BORDER_THIN);
dateStyle.setBorderBottom(XSSFCellStyle.BORDER_THIN);
dateStyle.setBorderRight(XSSFCellStyle.BORDER_THIN);
dateStyle.setBorderLeft(XSSFCellStyle.BORDER_THIN);// 아랫쪽에 얇은 실선 적용.
dateStyle.setVerticalAlignment(XSSFCellStyle.VERTICAL_CENTER);

sheet.setColumnWidth((short)0, (short)3000);
for(int z=1; z<5; z++){
    sheet.setColumnWidth((short)z, (short)6000);
}
sheet.setColumnWidth((short)3, (short)15000);
row = sheet.createRow((short)0);

cell=row.createCell(0);
cell.setCellValue("번호");
cell.setCellStyle(style);
cell=row.createCell(1);
cell.setCellValue("이름");
cell.setCellStyle(style);
cell=row.createCell(2);
cell.setCellValue("전화번호");
cell.setCellStyle(style);
cell=row.createCell(3);
cell.setCellValue("생년월일");
cell.setCellStyle(style);
cell=row.createCell(4);
cell.setCellValue("설문일자");
cell.setCellStyle(style);

if(list !=null && list.size() > 0){
    for(int k=0; k<list.size(); k++){
        row = sheet.createRow((short)k+1);
        cell=row.createCell(0);
        cell.setCellValue(k+1);
        cell.setCellStyle(dateStyle);
        cell=row.createCell(1);
        cell.setCellValue(list.get(k).getName());
        cell.setCellStyle(dateStyle);
        cell=row.createCell(2);
        cell.setCellValue(list.get(k).getPhone());
        cell.setCellStyle(dateStyle);
        cell=row.createCell(3);
        cell.setCellValue(list.get(k).getBirthday());
        cell.setCellStyle(dateStyle);
        cell=row.createCell(4);
        cell.setCellValue(list.get(k).getRegDatetime());
        cell.setCellStyle(dateStyle);
    }
}

try {
    fileOut = response.getOutputStream();
    workbook.write(fileOut);
    fileOut.close();
} catch (Exception e) {
    throw new RuntimeException("엑셀 다운로드에 실패하였습니다.");
}
```
